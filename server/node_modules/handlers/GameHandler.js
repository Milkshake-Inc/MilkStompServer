var Packet = require('packets/GamePackets');
var roomManager = require('room/RoomManager');

module.exports.joinRoomHandler = function (message, player) {
	var roomType = message.roomType;
	if (roomType !== undefined) {
		var room = roomManager.getAvailableRoom(roomType);
		if (room) {
			var spawn = room.spawnPoints[0];
			player.updatePosition(spawn.x, spawn.y);
			var packet = Packet.joinedRoomPacket(room, player);
			player.send(packet);
			room.addPlayer(player);
		}
	}
};

module.exports.leaveRoomHandler = function (message, player) {
	var room = player.room;
	room.removePlayer(player);
	player.send(Packet.leftRoom());
};

module.exports.moveHandler = function (message, player) {
	var x = message.x || 0;
	var y = message.y || 0;
	player.updatePosition(x, y);
	player.room.sendToAll(Packet.playerMovePacket(player), player);
};